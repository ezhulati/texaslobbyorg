---
import Layout from '@/components/astro/Layout.astro';
import AuthForm from '@/components/react/AuthForm';
import { createServerAuthClient } from '@/lib/supabase';

// Redirect if already logged in
const supabase = createServerAuthClient(Astro.cookies);
const { data: { user } } = await supabase.auth.getUser();
if (user) {
  return Astro.redirect('/dashboard');
}

// SEO-optimized title (55-60 chars) and description (155-160 chars)
const pageTitle = 'Log In | Access Your Texas Lobbyist Profile';
const pageDescription = 'Sign in to your TexasLobby.org account. Manage your lobbyist profile, update client information, track views, and connect with Texas businesses seeking advocacy.';
---

<Layout title={pageTitle} description={pageDescription}>
  <!-- Login Page -->
  <section class="py-16 min-h-[calc(100vh-4rem)]">
    <div class="max-w-md mx-auto px-4">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold mb-3">Welcome Back</h1>
        <p class="text-lg text-muted-foreground">
          Sign in to access your lobbyist profile and dashboard
        </p>
      </div>

      <!-- Login Form -->
      <div class="rounded-lg border border-border bg-white p-8 shadow-sm">
        <AuthForm client:load mode="login" redirectTo="/dashboard" />
      </div>

      <!-- Additional Info -->
      <div class="mt-8 text-center">
        <p class="text-sm text-muted-foreground mb-4">
          Looking for a lobbyist?{' '}
          <a href="/lobbyists" class="text-texas-blue-500 hover:underline">
            Browse our directory
          </a>
        </p>
        <p class="text-sm text-muted-foreground">
          Are you a lobbyist but don't have an account?{' '}
          <a href="/claim-profile" class="text-texas-blue-500 hover:underline">
            Claim your profile
          </a>
        </p>
      </div>
    </div>
  </section>
</Layout>
